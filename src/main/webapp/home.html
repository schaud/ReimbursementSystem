<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Reimbursements</title>
</head>
<body>
<div style="text-align: left">
    <h1>Welcome to Reimbursements!</h1>
    <h2 id="usernameHeading"> You are logged in as: </h2>


</div>

<button id="getAllReimburse" type="button" onclick="getEmpReimbursements()">View Your Reimbursements</button>
<button id="submitReimburse" type="button" onclick="getEmpReimbursements()">Submit a New Reimbursement Request</button>

<form name= "logoutform" action="/logout" method="get">
    <input type="submit" value="Log Out">
</form>

<table id="reimbursementTable"></table>

</body>


<script>

    async function showUser(){


        let httpResponse = await fetch("http://localhost:8080/home");
        let body = await httpResponse.text();

        document.getElementById("usernameHeading").innerHTML += body;
        console.log("finished show user")
    }
    showUser()


    async function getEmpReimbursements(){
        let httpResponse = await fetch("http://localhost:8080/api/employeereimbursements");
        let reimbursements = await httpResponse.json();
        let tableData = document.getElementById("reimbursementTable");

        tableData.innerHTML = "<thread><tr><th>Reimbursement ID</th><th>Employee ID</th><th>Amount</th><th>Description</th><th>Status</th><th>Handling Manager</th></tr></thread>"

        for (reimbursement of reimbursements){
            tableData.innerHTML = tableData.innerHTML +
                `<tr><td>${reimbursement.reimbursementID}</td>
            <td>${reimbursement.requesterID}</td>
            <td>${reimbursement.amount}</td>
            <td>${reimbursement.description}</td>
            <td>${reimbursement.status}</td>
            <td>${reimbursement.managerID}</td>`
        }

    }




</script>
</html>
